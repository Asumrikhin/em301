Неправильная спецификация модели
--------------------------------

```{r, echo=FALSE}
opts_chunk$set(cache=TRUE)
opts_chunk$set(warning=FALSE)
```

```{r}
library(ggplot2)
# предварительно пакет ggplot2 надо скачать 
# install.packages("ggplot2")
```



Часть 2.

Сравнить распределение оценки коэффициента $\hat{\beta}_2$ графически и сделать выводы в следующих случаях.

Во всех моделях предполагается, что $x\sim N(0,1)$, $\varepsilon\sim N(0,1)$.


* Случай 1.

Истинная модель имеет вид $y=2+3x+\varepsilon$.

С помощью графиков сравните распределение оценки $\hat{\beta}_2$ в двух случаях: оценивается истинная модель, оценивается модель $\hat




Примеры в помощь:


* Пример 1. Оцениваем истинную модель


```{r}
n.obs <- 300 # задаём число наблюдений

# задаём число экспериментов по оценке модели
n.exp <- 10000 

vec.hb2 <- rep(0,n.exp) # вектор из n.exp нулей

# n.exp раз будем делать то, что в фигурных скобках
for (i in 1:n.exp) {  
  
x <- rnorm(n.obs,mean=0,sd=1)
epsilon <- rnorm(n.obs,mean=0,sd=1)
y <- 2+0.3*x+epsilon

m1 <- lm(y~x)

# запомним в переменную vec.hb2[i] второй коэффициент
vec.hb2[i] <- m1$coefficients[2]
}
```

Гистограмма оценок $\hat{\beta}_2$:

```{r}
qplot(vec.hb2,binwidth=0.005,main="Гистограмма")
```


* Пример 2. Для сравнения законов распределения удобно их нарисовать на одном графике. Например, можно использовать один из трёх предложенных графиков. Можно использовать и другие графики! Эти три даны для примера, а не для ограничения свободы выбора.

```{r}
# генерим данные
x1 <- rnorm(n.obs,mean=0,sd=1)
x2 <- rnorm(n.obs,mean=1,sd=4)

# из двух иксов создаём табличку, 
# в первом столбце они будут идти друг за другом
# во втором столбце будет стоять название переменной
x.num <- factor(rep(c("X1","X2"),each=n.obs))
x.combined <- data.frame(x.data=c(x1,x2),x.num)
```
    * Две наложенные гистограммы
```{r}
ggplot(x.combined, aes(x=x.data, fill=x.num)) + geom_histogram(binwidth=.5, alpha=.5, position="identity")
```
    * Две чередующиеся гистограммы
```{r}
ggplot(x.combined, aes(x=x.data, fill=x.num)) + geom_histogram(binwidth=.5, position="dodge")
```
    * Две сглаженные функции плотности
```{r}
ggplot(x.combined, aes(x=x.data, fill=x.num)) + geom_density(alpha=0.3)
```

